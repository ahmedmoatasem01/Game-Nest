@page
@model GameNest.Pages.FriendsModel
@{
    ViewData["Title"] = "Friends";
}

<header>
    <nav class="navbar navbar-expand-lg custom_nav-container">
        <a class="navbar-brand" asp-area="" asp-page="/Home">
            <h1 style="color: #1e90ff;">🎮 GameNest</h1>
        </a>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav">
                <li class="nav-item ">
                    <a class="nav-link" asp-area="" asp-page="/Home">Home</a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" asp-area="" asp-page="/Profile">Profile</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" asp-area="" asp-page="/Event">Event</a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" asp-area="" asp-page="/Games">Games</a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" asp-area="" asp-page="/Friends">Friends</a>
                </li>
            </ul>
        </div>
    </nav>
</header>
<body>
    <div class="container">
        <div class="row">
            <!-- Friends List -->
            <div class="col-md-3 sidebar" id="friendsList">
            </div>

            <!-- Chat Section -->
            <div class="col-md-9 chat-section">
                <div class="chat-header" id="chatHeader">Select a friend to chat</div>
                <div class="chat-messages" id="chatMessages">
                </div>
                <div class="chat-input">
                    <input type="text" id="chatInput" placeholder="Type a message" disabled>
                    <button onclick="sendMessage()" id="sendButton" disabled>Send</button>
                </div>
            </div>
        </div>
    </div>

    <div id="callingModal" class="calling-modal">
        <h2>Calling <span id="callingFriendName"></span>...</h2>
        <button onclick="endCall()">End Call</button>
    </div>

    <script>
        const friends = [
            { name: "PlayerOne", email: "playerone@example.com", messages: [] },
            { name: "DragonSlayer", email: "dragonslayer@example.com", messages: [] }
        ];
        let currentChat = null;

        const friendsList = document.getElementById('friendsList');
        const chatHeader = document.getElementById('chatHeader');
        const chatMessages = document.getElementById('chatMessages');
        const chatInput = document.getElementById('chatInput');
        const sendButton = document.getElementById('sendButton');
        const callingModal = document.getElementById('callingModal');
        const callingFriendName = document.getElementById('callingFriendName');

        function renderFriends() {
            friendsList.innerHTML = '';
            friends.forEach((friend, index) => {
                const friendDiv = document.createElement('div');
                friendDiv.className = 'friend';
                friendDiv.innerHTML = `
                            <span class="friend-name">${friend.name}</span>
                            <div>
                                <button onclick="callFriend('${friend.name}')">Call</button>
                                <button onclick="removeFriend(${index})">Remove</button>
                            </div>
                        `;
                friendDiv.onclick = () => openChat(index);
                friendsList.appendChild(friendDiv);
            });
        }

        function openChat(index) {
            currentChat = friends[index];
            chatHeader.textContent = `Chat with ${currentChat.name}`;
            chatInput.disabled = false;
            sendButton.disabled = false;
            renderMessages();
        }

        function renderMessages() {
            chatMessages.innerHTML = '';
            currentChat.messages.forEach(message => {
                const messageP = document.createElement('p');
                messageP.textContent = message;
                chatMessages.appendChild(messageP);
            });
        }

        function sendMessage() {
            const message = chatInput.value.trim();
            if (message && currentChat) {
                currentChat.messages.push(message);
                renderMessages();
                chatInput.value = '';
            }
        }

        function removeFriend(index) {
            if (confirm(`Are you sure you want to remove ${friends[index].name}?`)) {
                friends.splice(index, 1);
                if (currentChat === friends[index]) {
                    currentChat = null;
                    chatHeader.textContent = 'Select a friend to chat';
                    chatInput.disabled = true;
                    sendButton.disabled = true;
                }
                renderFriends();
            }
        }

        function callFriend(name) {
            callingFriendName.textContent = name;
            callingModal.style.display = 'block';
        }

        function endCall() {
            callingModal.style.display = 'none';
        }

        renderFriends();
    </script>
    <style>
        body {
            background-color: #1f1f1f;
            color: white;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        header {
            background-color: #1f1f1f;
            padding: 20px 0;
            text-align: center;
            border-bottom: 1px solid #333;
        }

            header h1 {
                color: #1e90ff;
                font-size: 2.5rem;
                margin: 0 0 10px 0;
            }

        nav ul {
            list-style: none;
            padding: 0;
            display: flex;
            justify-content: center;
            margin: 0;
        }

            nav ul li {
                margin: 0 15px;
            }

                nav ul li a {
                    text-decoration: none;
                    color: #e0e0e0;
                    font-weight: bold;
                    padding: 5px 10px;
                    font-size: 1rem;
                }

                    nav ul li a.active,
                    nav ul li a:hover {
                        color: #1e90ff;
                        border-bottom: 2px solid #1e90ff;
                    }

        .container {
            margin-top: 20px;
        }

        .sidebar {
            background-color: #1e1e1e;
            padding: 20px;
            border-radius: 5px;
            height: 100%;
        }

        .friend {
            padding: 10px;
            margin-bottom: 10px;
            background-color: #2c2c2c;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .friend-name {
            color: white;
        }

        .friend:hover {
            background-color: #333;
        }

        .friend button {
            background-color: #2196f3;
            border: none;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
        }

            .friend button:hover {
                background-color: #1e90ff;
            }

        .chat-section {
            background-color: #1f1f1f;
            padding: 20px;
            border-radius: 5px;
        }

        .chat-header {
            font-size: 1.5rem;
            color: #2196f3;
            margin-bottom: 10px;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            background-color: #121212;
            border-radius: 5px;
            margin-bottom: 10px;
            height: 300px;
        }

            .chat-messages p {
                padding: 10px;
                margin-bottom: 10px;
                background-color: #2c2c2c;
                border-radius: 5px;
            }

        .chat-input {
            display: flex;
        }

            .chat-input input {
                flex: 1;
                padding: 10px;
                border: none;
                border-radius: 5px;
                background: #2c2c2c;
                color: #e0e0e0;
                margin-right: 10px;
            }

            .chat-input button {
                padding: 10px 20px;
                border: none;
                background-color: #2196f3;
                color: white;
                cursor: pointer;
                border-radius: 5px;
            }

                .chat-input button:hover {
                    background-color: #1e90ff;
                }

        .calling-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #1e1e1e;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.7);
        }

            .calling-modal h2 {
                color: #2196f3;
            }

            .calling-modal button {
                margin-top: 10px;
                background-color: #2196f3;
                border: none;
                color: white;
                padding: 10px;
                border-radius: 5px;
                cursor: pointer;
            }

                .calling-modal button:hover {
                    background-color: #1e90ff;
                }
    </style>
</body>
